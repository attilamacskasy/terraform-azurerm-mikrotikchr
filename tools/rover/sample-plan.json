{"format_version":"1.2","terraform_version":"1.7.2","planned_values":{"root_module":{"child_modules":[{"resources":[{"address":"module.nsg.azurerm_network_security_group.nsg","mode":"managed","type":"azurerm_network_security_group","name":"nsg","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"location":"westeurope","name":"nsg-mikrotik-chr","resource_group_name":"rg-hub-net-shared-001","tags":null,"timeouts":null},"sensitive_values":{"security_rule":[]}},{"address":"module.nsg.azurerm_network_security_rule.security_rule[\"Allow_SSH\"]","mode":"managed","type":"azurerm_network_security_rule","name":"security_rule","index":"Allow_SSH","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access":"Allow","description":null,"destination_address_prefix":"*","destination_address_prefixes":null,"destination_application_security_group_ids":null,"destination_port_range":"22","destination_port_ranges":null,"direction":"Inbound","name":"Allow_SSH","network_security_group_name":"nsg-mikrotik-chr","priority":110,"protocol":"Tcp","resource_group_name":"rg-hub-net-shared-001","source_address_prefix":"*","source_address_prefixes":null,"source_application_security_group_ids":null,"source_port_range":"*","source_port_ranges":null,"timeouts":null},"sensitive_values":{}},{"address":"module.nsg.azurerm_network_security_rule.security_rule[\"Allow_Winbox\"]","mode":"managed","type":"azurerm_network_security_rule","name":"security_rule","index":"Allow_Winbox","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"access":"Allow","description":null,"destination_address_prefix":"*","destination_address_prefixes":null,"destination_application_security_group_ids":null,"destination_port_range":"8291","destination_port_ranges":null,"direction":"Inbound","name":"Allow_Winbox","network_security_group_name":"nsg-mikrotik-chr","priority":100,"protocol":"Tcp","resource_group_name":"rg-hub-net-shared-001","source_address_prefix":"*","source_address_prefixes":null,"source_application_security_group_ids":null,"source_port_range":"*","source_port_ranges":null,"timeouts":null},"sensitive_values":{}}],"address":"module.nsg"},{"resources":[{"address":"module.public_ip.azurerm_public_ip.public_ip","mode":"managed","type":"azurerm_public_ip","name":"public_ip","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"allocation_method":"Static","ddos_protection_mode":"VirtualNetworkInherited","ddos_protection_plan_id":null,"domain_name_label":null,"edge_zone":null,"idle_timeout_in_minutes":4,"ip_tags":null,"ip_version":"IPv4","location":"westeurope","name":"pip-mikrotik-chr","public_ip_prefix_id":null,"resource_group_name":"rg-hub-net-shared-001","reverse_fqdn":null,"sku":"Standard","sku_tier":"Regional","tags":null,"timeouts":null,"zones":["1"]},"sensitive_values":{"zones":[false]}}],"address":"module.public_ip"},{"resources":[{"address":"module.subnet_chr.azurerm_subnet.subnet_example","mode":"managed","type":"azurerm_subnet","name":"subnet_example","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_prefixes":["172.30.1.0/24"],"delegation":[],"name":"snet-chr-westeu-001","resource_group_name":"rg-hub-net-shared-001","service_endpoint_policy_ids":null,"service_endpoints":null,"timeouts":null,"virtual_network_name":"vnet-hub-westeu-001"},"sensitive_values":{"address_prefixes":[false],"delegation":[]}}],"address":"module.subnet_chr"},{"resources":[{"address":"module.vm_mikrotik.azurerm_image.image_mikrotik","mode":"managed","type":"azurerm_image","name":"image_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"data_disk":[],"hyper_v_generation":"V1","location":"westeurope","name":"img-vm-mikrotik-chr-7-18-2-vhd","os_disk":[{"blob_uri":"https://mikrotikchrstorage01.blob.core.windows.net/vhds/chr-7.18.2.vhd","caching":"ReadWrite","disk_encryption_set_id":null,"os_state":"Generalized","os_type":"Linux","size_gb":1}],"resource_group_name":"rg-hub-net-shared-001","source_virtual_machine_id":null,"tags":null,"timeouts":null,"zone_resilient":false},"sensitive_values":{"data_disk":[],"os_disk":[{}]}},{"address":"module.vm_mikrotik.azurerm_network_interface.ip_mikrotik","mode":"managed","type":"azurerm_network_interface","name":"ip_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"auxiliary_mode":null,"auxiliary_sku":null,"edge_zone":null,"enable_accelerated_networking":false,"enable_ip_forwarding":false,"ip_configuration":[{"name":"ip-mikrotik-chr","private_ip_address_allocation":"Dynamic","private_ip_address_version":"IPv4"}],"location":"westeurope","name":"vmnic-mikrotik-chr","resource_group_name":"rg-hub-net-shared-001","tags":null,"timeouts":null},"sensitive_values":{"applied_dns_servers":[],"dns_servers":[],"ip_configuration":[{}],"private_ip_addresses":[]}},{"address":"module.vm_mikrotik.azurerm_network_interface_security_group_association.nsg_association","mode":"managed","type":"azurerm_network_interface_security_group_association","name":"nsg_association","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"timeouts":null},"sensitive_values":{}},{"address":"module.vm_mikrotik.azurerm_route_table.rt_mikrotik","mode":"managed","type":"azurerm_route_table","name":"rt_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"disable_bgp_route_propagation":false,"location":"westeurope","name":"rt-mikrotik-chr","resource_group_name":"rg-hub-net-shared-001","route":[{"address_prefix":"172.22.22.0/24","name":"to_onpremises_lab","next_hop_in_ip_address":"172.30.1.4","next_hop_type":"VirtualAppliance"}],"tags":null,"timeouts":null},"sensitive_values":{"route":[{}],"subnets":[]}},{"address":"module.vm_mikrotik.azurerm_subnet_route_table_association.rt_ass_mikrotik","mode":"managed","type":"azurerm_subnet_route_table_association","name":"rt_ass_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"timeouts":null},"sensitive_values":{}},{"address":"module.vm_mikrotik.azurerm_virtual_machine.vm_mikrotik","mode":"managed","type":"azurerm_virtual_machine","name":"vm_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"additional_capabilities":[],"boot_diagnostics":[],"delete_data_disks_on_termination":false,"delete_os_disk_on_termination":false,"location":"westeurope","name":"vm-mikrotik-chr","os_profile":[{"admin_password":"not_used_moved_as_secret","admin_username":"cloudadmin","computer_name":"vm-mikrotik"}],"os_profile_linux_config":[{"disable_password_authentication":false,"ssh_keys":[]}],"os_profile_secrets":[],"os_profile_windows_config":[],"plan":[],"primary_network_interface_id":null,"proximity_placement_group_id":null,"resource_group_name":"rg-hub-net-shared-001","storage_image_reference":[{"offer":"","publisher":"","sku":""}],"storage_os_disk":[{"caching":"ReadWrite","create_option":"FromImage","disk_size_gb":10,"image_uri":null,"managed_disk_type":"StandardSSD_LRS","name":"vm-mikrotik-chr_disk1","os_type":"Linux","vhd_uri":null,"write_accelerator_enabled":false}],"tags":null,"timeouts":null,"vm_size":"Standard_B2ats_v2","zones":["1"]},"sensitive_values":{"additional_capabilities":[],"boot_diagnostics":[],"identity":[],"network_interface_ids":[],"os_profile":[{}],"os_profile_linux_config":[{"ssh_keys":[]}],"os_profile_secrets":[],"os_profile_windows_config":[],"plan":[],"storage_data_disk":[],"storage_image_reference":[{}],"storage_os_disk":[{}],"zones":[false]}}],"address":"module.vm_mikrotik"},{"resources":[{"address":"module.vnet_hub.azurerm_virtual_network.vnet_example","mode":"managed","type":"azurerm_virtual_network","name":"vnet_example","provider_name":"registry.terraform.io/hashicorp/azurerm","schema_version":0,"values":{"address_space":["172.30.0.0/16"],"bgp_community":null,"ddos_protection_plan":[],"edge_zone":null,"encryption":[],"flow_timeout_in_minutes":null,"location":"westeurope","name":"vnet-hub-westeu-001","resource_group_name":"rg-hub-net-shared-001","tags":null,"timeouts":null},"sensitive_values":{"address_space":[false],"ddos_protection_plan":[],"dns_servers":[],"encryption":[],"subnet":[]}}],"address":"module.vnet_hub"}]}},"resource_changes":[{"address":"module.nsg.azurerm_network_security_group.nsg","module_address":"module.nsg","mode":"managed","type":"azurerm_network_security_group","name":"nsg","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"location":"westeurope","name":"nsg-mikrotik-chr","resource_group_name":"rg-hub-net-shared-001","tags":null,"timeouts":null},"after_unknown":{"id":true,"security_rule":true},"before_sensitive":false,"after_sensitive":{"security_rule":[]}}},{"address":"module.nsg.azurerm_network_security_rule.security_rule[\"Allow_SSH\"]","module_address":"module.nsg","mode":"managed","type":"azurerm_network_security_rule","name":"security_rule","index":"Allow_SSH","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"access":"Allow","description":null,"destination_address_prefix":"*","destination_address_prefixes":null,"destination_application_security_group_ids":null,"destination_port_range":"22","destination_port_ranges":null,"direction":"Inbound","name":"Allow_SSH","network_security_group_name":"nsg-mikrotik-chr","priority":110,"protocol":"Tcp","resource_group_name":"rg-hub-net-shared-001","source_address_prefix":"*","source_address_prefixes":null,"source_application_security_group_ids":null,"source_port_range":"*","source_port_ranges":null,"timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.nsg.azurerm_network_security_rule.security_rule[\"Allow_Winbox\"]","module_address":"module.nsg","mode":"managed","type":"azurerm_network_security_rule","name":"security_rule","index":"Allow_Winbox","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"access":"Allow","description":null,"destination_address_prefix":"*","destination_address_prefixes":null,"destination_application_security_group_ids":null,"destination_port_range":"8291","destination_port_ranges":null,"direction":"Inbound","name":"Allow_Winbox","network_security_group_name":"nsg-mikrotik-chr","priority":100,"protocol":"Tcp","resource_group_name":"rg-hub-net-shared-001","source_address_prefix":"*","source_address_prefixes":null,"source_application_security_group_ids":null,"source_port_range":"*","source_port_ranges":null,"timeouts":null},"after_unknown":{"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.public_ip.azurerm_public_ip.public_ip","module_address":"module.public_ip","mode":"managed","type":"azurerm_public_ip","name":"public_ip","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"allocation_method":"Static","ddos_protection_mode":"VirtualNetworkInherited","ddos_protection_plan_id":null,"domain_name_label":null,"edge_zone":null,"idle_timeout_in_minutes":4,"ip_tags":null,"ip_version":"IPv4","location":"westeurope","name":"pip-mikrotik-chr","public_ip_prefix_id":null,"resource_group_name":"rg-hub-net-shared-001","reverse_fqdn":null,"sku":"Standard","sku_tier":"Regional","tags":null,"timeouts":null,"zones":["1"]},"after_unknown":{"fqdn":true,"id":true,"ip_address":true,"zones":[false]},"before_sensitive":false,"after_sensitive":{"zones":[false]}}},{"address":"module.subnet_chr.azurerm_subnet.subnet_example","module_address":"module.subnet_chr","mode":"managed","type":"azurerm_subnet","name":"subnet_example","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"address_prefixes":["172.30.1.0/24"],"delegation":[],"name":"snet-chr-westeu-001","resource_group_name":"rg-hub-net-shared-001","service_endpoint_policy_ids":null,"service_endpoints":null,"timeouts":null,"virtual_network_name":"vnet-hub-westeu-001"},"after_unknown":{"address_prefixes":[false],"delegation":[],"enforce_private_link_endpoint_network_policies":true,"enforce_private_link_service_network_policies":true,"id":true,"private_endpoint_network_policies_enabled":true,"private_link_service_network_policies_enabled":true},"before_sensitive":false,"after_sensitive":{"address_prefixes":[false],"delegation":[]}}},{"address":"module.vm_mikrotik.azurerm_image.image_mikrotik","module_address":"module.vm_mikrotik","mode":"managed","type":"azurerm_image","name":"image_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"data_disk":[],"hyper_v_generation":"V1","location":"westeurope","name":"img-vm-mikrotik-chr-7-18-2-vhd","os_disk":[{"blob_uri":"https://mikrotikchrstorage01.blob.core.windows.net/vhds/chr-7.18.2.vhd","caching":"ReadWrite","disk_encryption_set_id":null,"os_state":"Generalized","os_type":"Linux","size_gb":1}],"resource_group_name":"rg-hub-net-shared-001","source_virtual_machine_id":null,"tags":null,"timeouts":null,"zone_resilient":false},"after_unknown":{"data_disk":[],"id":true,"os_disk":[{"managed_disk_id":true}]},"before_sensitive":false,"after_sensitive":{"data_disk":[],"os_disk":[{}]}}},{"address":"module.vm_mikrotik.azurerm_network_interface.ip_mikrotik","module_address":"module.vm_mikrotik","mode":"managed","type":"azurerm_network_interface","name":"ip_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"auxiliary_mode":null,"auxiliary_sku":null,"edge_zone":null,"enable_accelerated_networking":false,"enable_ip_forwarding":false,"ip_configuration":[{"name":"ip-mikrotik-chr","private_ip_address_allocation":"Dynamic","private_ip_address_version":"IPv4"}],"location":"westeurope","name":"vmnic-mikrotik-chr","resource_group_name":"rg-hub-net-shared-001","tags":null,"timeouts":null},"after_unknown":{"applied_dns_servers":true,"dns_servers":true,"id":true,"internal_dns_name_label":true,"internal_domain_name_suffix":true,"ip_configuration":[{"gateway_load_balancer_frontend_ip_configuration_id":true,"primary":true,"private_ip_address":true,"public_ip_address_id":true,"subnet_id":true}],"mac_address":true,"private_ip_address":true,"private_ip_addresses":true,"virtual_machine_id":true},"before_sensitive":false,"after_sensitive":{"applied_dns_servers":[],"dns_servers":[],"ip_configuration":[{}],"private_ip_addresses":[]}}},{"address":"module.vm_mikrotik.azurerm_network_interface_security_group_association.nsg_association","module_address":"module.vm_mikrotik","mode":"managed","type":"azurerm_network_interface_security_group_association","name":"nsg_association","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"timeouts":null},"after_unknown":{"id":true,"network_interface_id":true,"network_security_group_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.vm_mikrotik.azurerm_route_table.rt_mikrotik","module_address":"module.vm_mikrotik","mode":"managed","type":"azurerm_route_table","name":"rt_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"disable_bgp_route_propagation":false,"location":"westeurope","name":"rt-mikrotik-chr","resource_group_name":"rg-hub-net-shared-001","route":[{"address_prefix":"172.22.22.0/24","name":"to_onpremises_lab","next_hop_in_ip_address":"172.30.1.4","next_hop_type":"VirtualAppliance"}],"tags":null,"timeouts":null},"after_unknown":{"id":true,"route":[{}],"subnets":true},"before_sensitive":false,"after_sensitive":{"route":[{}],"subnets":[]}}},{"address":"module.vm_mikrotik.azurerm_subnet_route_table_association.rt_ass_mikrotik","module_address":"module.vm_mikrotik","mode":"managed","type":"azurerm_subnet_route_table_association","name":"rt_ass_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"timeouts":null},"after_unknown":{"id":true,"route_table_id":true,"subnet_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.vm_mikrotik.azurerm_virtual_machine.vm_mikrotik","module_address":"module.vm_mikrotik","mode":"managed","type":"azurerm_virtual_machine","name":"vm_mikrotik","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"additional_capabilities":[],"boot_diagnostics":[],"delete_data_disks_on_termination":false,"delete_os_disk_on_termination":false,"location":"westeurope","name":"vm-mikrotik-chr","os_profile":[{"admin_password":"not_used_moved_as_secret","admin_username":"cloudadmin","computer_name":"vm-mikrotik"}],"os_profile_linux_config":[{"disable_password_authentication":false,"ssh_keys":[]}],"os_profile_secrets":[],"os_profile_windows_config":[],"plan":[],"primary_network_interface_id":null,"proximity_placement_group_id":null,"resource_group_name":"rg-hub-net-shared-001","storage_image_reference":[{"offer":"","publisher":"","sku":""}],"storage_os_disk":[{"caching":"ReadWrite","create_option":"FromImage","disk_size_gb":10,"image_uri":null,"managed_disk_type":"StandardSSD_LRS","name":"vm-mikrotik-chr_disk1","os_type":"Linux","vhd_uri":null,"write_accelerator_enabled":false}],"tags":null,"timeouts":null,"vm_size":"Standard_B2ats_v2","zones":["1"]},"after_unknown":{"additional_capabilities":[],"availability_set_id":true,"boot_diagnostics":[],"id":true,"identity":true,"license_type":true,"network_interface_ids":true,"os_profile":[{"custom_data":true}],"os_profile_linux_config":[{"ssh_keys":[]}],"os_profile_secrets":[],"os_profile_windows_config":[],"plan":[],"storage_data_disk":true,"storage_image_reference":[{"id":true,"version":true}],"storage_os_disk":[{"managed_disk_id":true}],"zones":[false]},"before_sensitive":false,"after_sensitive":{"additional_capabilities":[],"boot_diagnostics":[],"identity":[],"network_interface_ids":[],"os_profile":true,"os_profile_linux_config":[{"ssh_keys":[]}],"os_profile_secrets":[],"os_profile_windows_config":[],"plan":[],"storage_data_disk":[],"storage_image_reference":[{}],"storage_os_disk":[{}],"zones":[false]}}},{"address":"module.vnet_hub.azurerm_virtual_network.vnet_example","module_address":"module.vnet_hub","mode":"managed","type":"azurerm_virtual_network","name":"vnet_example","provider_name":"registry.terraform.io/hashicorp/azurerm","change":{"actions":["create"],"before":null,"after":{"address_space":["172.30.0.0/16"],"bgp_community":null,"ddos_protection_plan":[],"edge_zone":null,"encryption":[],"flow_timeout_in_minutes":null,"location":"westeurope","name":"vnet-hub-westeu-001","resource_group_name":"rg-hub-net-shared-001","tags":null,"timeouts":null},"after_unknown":{"address_space":[false],"ddos_protection_plan":[],"dns_servers":true,"encryption":[],"guid":true,"id":true,"subnet":true},"before_sensitive":false,"after_sensitive":{"address_space":[false],"ddos_protection_plan":[],"dns_servers":[],"encryption":[],"subnet":[]}}}],"configuration":{"provider_config":{"azurerm":{"name":"azurerm","full_name":"registry.terraform.io/hashicorp/azurerm","version_constraint":"~\u003e 3.80.0","expressions":{"features":[{}],"skip_provider_registration":{"constant_value":true}}}},"root_module":{"module_calls":{"nsg":{"source":"./modules/nsg","expressions":{"location":{"references":["local.params.location","local.params"]},"nsg_name":{"references":["local.params.nsg_name","local.params"]},"resource_group_name":{"references":["local.params.resource_group","local.params"]},"security_rules":{"constant_value":[{"access":"Allow","destination_address_prefix":"*","destination_port_range":"8291","direction":"Inbound","name":"Allow_Winbox","priority":100,"protocol":"Tcp","source_address_prefix":"*","source_port_range":"*"},{"access":"Allow","destination_address_prefix":"*","destination_port_range":"22","direction":"Inbound","name":"Allow_SSH","priority":110,"protocol":"Tcp","source_address_prefix":"*","source_port_range":"*"}]}},"module":{"outputs":{"nsg_id":{"expression":{"references":["azurerm_network_security_group.nsg.id","azurerm_network_security_group.nsg"]}}},"resources":[{"address":"azurerm_network_security_group.nsg","mode":"managed","type":"azurerm_network_security_group","name":"nsg","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.nsg_name"]},"resource_group_name":{"references":["var.resource_group_name"]},"tags":{"constant_value":{}}},"schema_version":0},{"address":"azurerm_network_security_rule.security_rule","mode":"managed","type":"azurerm_network_security_rule","name":"security_rule","provider_config_key":"azurerm","expressions":{"access":{"references":["each.value.access","each.value"]},"destination_address_prefix":{"references":["each.value.destination_address_prefix","each.value"]},"destination_port_range":{"references":["each.value.destination_port_range","each.value"]},"direction":{"references":["each.value.direction","each.value"]},"name":{"references":["each.value.name","each.value"]},"network_security_group_name":{"references":["azurerm_network_security_group.nsg.name","azurerm_network_security_group.nsg"]},"priority":{"references":["each.value.priority","each.value"]},"protocol":{"references":["each.value.protocol","each.value"]},"resource_group_name":{"references":["var.resource_group_name"]},"source_address_prefix":{"references":["each.value.source_address_prefix","each.value"]},"source_port_range":{"references":["each.value.source_port_range","each.value"]}},"schema_version":0,"for_each_expression":{"references":["var.security_rules"]}}],"variables":{"location":{"description":"Azure region/location"},"nsg_name":{"description":"Name of the Network Security Group"},"resource_group_name":{"description":"Name of the resource group"},"security_rules":{"description":"List of security rules for the NSG"}}}},"public_ip":{"source":"./modules/pip","expressions":{"allocation_method":{"constant_value":"Static"},"location":{"references":["local.params.location","local.params"]},"public_ip_name":{"references":["local.params.public_ip_name","local.params"]},"resource_group_name":{"references":["local.params.resource_group","local.params"]},"sku":{"constant_value":"Standard"},"zones":{"constant_value":["1"]}},"module":{"outputs":{"public_ip_id":{"expression":{"references":["azurerm_public_ip.public_ip.id","azurerm_public_ip.public_ip"]}}},"resources":[{"address":"azurerm_public_ip.public_ip","mode":"managed","type":"azurerm_public_ip","name":"public_ip","provider_config_key":"azurerm","expressions":{"allocation_method":{"references":["var.allocation_method"]},"location":{"references":["var.location"]},"name":{"references":["var.public_ip_name"]},"resource_group_name":{"references":["var.resource_group_name"]},"sku":{"references":["var.sku"]},"tags":{"constant_value":{}},"zones":{"references":["var.zones"]}},"schema_version":0}],"variables":{"allocation_method":{"default":"Static","description":"Allocation method for the public IP (Dynamic or Static)"},"location":{"description":"Azure region/location"},"public_ip_name":{"description":"Name of the public IP address"},"resource_group_name":{"description":"Name of the resource group"},"sku":{"default":"Standard","description":"SKU for the public IP (Basic or Standard)"},"zones":{"default":[],"description":"Specifies the Availability Zone to place the Public IP in."}}}},"subnet_chr":{"source":"./modules/subnet","expressions":{"resource_group":{"references":["local.params.resource_group","local.params"]},"subnet_name":{"references":["local.params.subnet_name","local.params"]},"subnet_prefixes":{"constant_value":["172.30.1.0/24"]},"virtual_network_name":{"references":["module.vnet_hub.vnet_name","module.vnet_hub"]}},"module":{"outputs":{"subnet_id":{"expression":{"references":["azurerm_subnet.subnet_example.id","azurerm_subnet.subnet_example"]},"description":"ID for Subnet"}},"resources":[{"address":"azurerm_subnet.subnet_example","mode":"managed","type":"azurerm_subnet","name":"subnet_example","provider_config_key":"azurerm","expressions":{"address_prefixes":{"references":["var.subnet_prefixes"]},"name":{"references":["var.subnet_name"]},"resource_group_name":{"references":["var.resource_group"]},"virtual_network_name":{"references":["var.virtual_network_name"]}},"schema_version":0}],"variables":{"resource_group":{"description":"The name of the resource group in which to create the subnet"},"subnet_name":{"description":"The name of the subnet"},"subnet_prefixes":{"description":"The address prefix to use for the subnet"},"virtual_network_name":{"description":"The name of the virtual network to which to attach the subnet"}}}},"vm_mikrotik":{"source":"./modules/mikrotik","expressions":{"az_subnet_id":{"references":["module.subnet_chr.subnet_id","module.subnet_chr"]},"azurerm_image_name":{"references":["local.params.azurerm_image_name","local.params"]},"azurerm_network_interface_name":{"references":["local.params.azurerm_network_interface_name","local.params"]},"azurerm_route_table_name":{"references":["local.params.azurerm_route_table_name","local.params"]},"azurerm_virtual_machine_name":{"references":["local.params.azurerm_virtual_machine_name","local.params"]},"azurerm_virtual_machine_vm_size":{"references":["local.params.azurerm_virtual_machine_vm_size","local.params"]},"ip_configuration_name":{"references":["local.params.ip_configuration_name","local.params"]},"location":{"references":["local.params.location","local.params"]},"nsg_id":{"references":["module.nsg.nsg_id","module.nsg"]},"os_profile_admin_password":{"references":["local.params.os_profile_admin_password","local.params"]},"public_ip_address_id":{"references":["module.public_ip.public_ip_id","module.public_ip"]},"resource_group":{"references":["local.params.resource_group","local.params"]},"storage_os_disk_managed_disk_type":{"references":["local.params.storage_os_disk_managed_disk_type","local.params"]},"storage_os_disk_name":{"references":["local.params.storage_os_disk_name","local.params"]}},"module":{"resources":[{"address":"azurerm_image.image_mikrotik","mode":"managed","type":"azurerm_image","name":"image_mikrotik","provider_config_key":"azurerm","expressions":{"hyper_v_generation":{"constant_value":"V1"},"location":{"references":["var.location"]},"name":{"references":["var.azurerm_image_name"]},"os_disk":[{"blob_uri":{"constant_value":"https://mikrotikchrstorage01.blob.core.windows.net/vhds/chr-7.18.2.vhd"},"caching":{"constant_value":"ReadWrite"},"os_state":{"constant_value":"Generalized"},"os_type":{"constant_value":"Linux"},"size_gb":{"constant_value":1}}],"resource_group_name":{"references":["var.resource_group"]},"tags":{"constant_value":{}},"zone_resilient":{"constant_value":false}},"schema_version":0},{"address":"azurerm_network_interface.ip_mikrotik","mode":"managed","type":"azurerm_network_interface","name":"ip_mikrotik","provider_config_key":"azurerm","expressions":{"ip_configuration":[{"name":{"references":["var.ip_configuration_name"]},"private_ip_address_allocation":{"constant_value":"Dynamic"},"public_ip_address_id":{"references":["var.public_ip_address_id"]},"subnet_id":{"references":["var.az_subnet_id"]}}],"location":{"references":["var.location"]},"name":{"references":["var.azurerm_network_interface_name"]},"resource_group_name":{"references":["var.resource_group"]}},"schema_version":0},{"address":"azurerm_network_interface_security_group_association.nsg_association","mode":"managed","type":"azurerm_network_interface_security_group_association","name":"nsg_association","provider_config_key":"azurerm","expressions":{"network_interface_id":{"references":["azurerm_network_interface.ip_mikrotik.id","azurerm_network_interface.ip_mikrotik"]},"network_security_group_id":{"references":["var.nsg_id"]}},"schema_version":0},{"address":"azurerm_route_table.rt_mikrotik","mode":"managed","type":"azurerm_route_table","name":"rt_mikrotik","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.azurerm_route_table_name"]},"resource_group_name":{"references":["var.resource_group"]},"route":{"constant_value":[{"address_prefix":"172.22.22.0/24","name":"to_onpremises_lab","next_hop_in_ip_address":"172.30.1.4","next_hop_type":"VirtualAppliance"}]}},"schema_version":0},{"address":"azurerm_subnet_route_table_association.rt_ass_mikrotik","mode":"managed","type":"azurerm_subnet_route_table_association","name":"rt_ass_mikrotik","provider_config_key":"azurerm","expressions":{"route_table_id":{"references":["azurerm_route_table.rt_mikrotik.id","azurerm_route_table.rt_mikrotik"]},"subnet_id":{"references":["var.az_subnet_id"]}},"schema_version":0},{"address":"azurerm_virtual_machine.vm_mikrotik","mode":"managed","type":"azurerm_virtual_machine","name":"vm_mikrotik","provider_config_key":"azurerm","expressions":{"location":{"references":["var.location"]},"name":{"references":["var.azurerm_virtual_machine_name"]},"network_interface_ids":{"references":["azurerm_network_interface.ip_mikrotik.id","azurerm_network_interface.ip_mikrotik"]},"os_profile":[{"admin_password":{"references":["var.os_profile_admin_password"]},"admin_username":{"constant_value":"cloudadmin"},"computer_name":{"constant_value":"vm-mikrotik"}}],"os_profile_linux_config":[{"disable_password_authentication":{"constant_value":false}}],"resource_group_name":{"references":["var.resource_group"]},"storage_image_reference":[{"id":{"references":["azurerm_image.image_mikrotik.id","azurerm_image.image_mikrotik"]}}],"storage_os_disk":[{"caching":{"constant_value":"ReadWrite"},"create_option":{"constant_value":"FromImage"},"disk_size_gb":{"constant_value":10},"managed_disk_type":{"references":["var.storage_os_disk_managed_disk_type"]},"name":{"references":["var.storage_os_disk_name"]},"os_type":{"constant_value":"Linux"},"write_accelerator_enabled":{"constant_value":false}}],"vm_size":{"references":["var.azurerm_virtual_machine_vm_size"]},"zones":{"constant_value":["1"]}},"schema_version":0}],"variables":{"az_subnet_id":{"description":"ID of the subnet"},"azurerm_image_name":{"description":"Name of the Mikrotik image"},"azurerm_network_interface_name":{"description":"Name of the network interface"},"azurerm_route_table_name":{"description":"Name of the route table"},"azurerm_virtual_machine_name":{"description":"Name of the virtual machine"},"azurerm_virtual_machine_vm_size":{"description":"Size of the virtual machine"},"ip_configuration_name":{"description":"Name of the IP configuration"},"location":{"description":"Azure region/location"},"nsg_id":{"description":"ID of the Network Security Group"},"os_profile_admin_password":{"description":"Admin password for CHR"},"public_ip_address_id":{"description":"ID of the public IP address"},"resource_group":{"description":"Name of the resource group"},"storage_os_disk_managed_disk_type":{"description":"Managed disk type for the OS disk"},"storage_os_disk_name":{"description":"Name of the OS disk"}}}},"vnet_hub":{"source":"./modules/vnet","expressions":{"address_space":{"constant_value":["172.30.0.0/16"]},"resource_group":{"references":["local.params.resource_group","local.params"]},"vnet_location":{"references":["local.params.location","local.params"]},"vnet_name":{"references":["local.params.vnet_name","local.params"]}},"module":{"outputs":{"vnet_id":{"expression":{"references":["azurerm_virtual_network.vnet_example.id","azurerm_virtual_network.vnet_example"]},"description":"Vnet ID"},"vnet_name":{"expression":{"references":["azurerm_virtual_network.vnet_example.name","azurerm_virtual_network.vnet_example"]},"description":"Vnet name"}},"resources":[{"address":"azurerm_virtual_network.vnet_example","mode":"managed","type":"azurerm_virtual_network","name":"vnet_example","provider_config_key":"azurerm","expressions":{"address_space":{"references":["var.address_space"]},"dns_servers":{"references":["var.dns_servers"]},"location":{"references":["var.vnet_location"]},"name":{"references":["var.vnet_name"]},"resource_group_name":{"references":["var.resource_group"]}},"schema_version":0}],"variables":{"address_space":{"description":"The address space that is used the virtual network. You can supply more than one address space"},"dns_servers":{"default":null,"description":"List of IP addresses of DNS servers"},"resource_group":{"description":"The name of the resource group in which to create the virtual network"},"subnet":{"default":[],"description":"Optional feature to be used in-line within the Network Security Group resource. Check advanced example for usage"},"vnet_location":{"description":"The location/region where the virtual network is created"},"vnet_name":{"description":"The name of the virtual network"}}}}}}},"relevant_attributes":[{"resource":"module.vm_mikrotik.azurerm_image.image_mikrotik","attribute":["id"]},{"resource":"module.nsg.azurerm_network_security_group.nsg","attribute":["id"]},{"resource":"module.vnet_hub.azurerm_virtual_network.vnet_example","attribute":["name"]},{"resource":"module.vnet_hub.azurerm_virtual_network.vnet_example","attribute":["id"]},{"resource":"module.subnet_chr.azurerm_subnet.subnet_example","attribute":["id"]},{"resource":"module.nsg.azurerm_network_security_group.nsg","attribute":["name"]},{"resource":"module.vm_mikrotik.azurerm_route_table.rt_mikrotik","attribute":["id"]},{"resource":"module.vm_mikrotik.azurerm_network_interface.ip_mikrotik","attribute":["id"]},{"resource":"module.public_ip.azurerm_public_ip.public_ip","attribute":["id"]}],"timestamp":"2025-04-22T11:18:18Z","errored":false}
